# Caddyfile template for frontend-development-proxy sidecar
# Note:
# Port {{ chrome_port }} - Resources from insights-chrome-dev image
# Port {{ app_port }} - Resources from application to test

@root path /
handle @root {
    reverse_proxy 127.0.0.1:{{ chrome_port }}
}

handle /index.html {
    reverse_proxy 127.0.0.1:{{ chrome_port }}
}

handle /apps/chrome* {
    reverse_proxy 127.0.0.1:{{ chrome_port }}
}

handle /apps/{{ app_name }}* {
    reverse_proxy 127.0.0.1:{{ app_port }}
}
{% for route_prefix in route_prefixes %}
handle /{{ route_prefix }}/{{ app_name }}* {
    reverse_proxy 127.0.0.1:{{ chrome_port }}
}
{% endfor %}
handle /{{ app_name }}* {
    reverse_proxy 127.0.0.1:{{ chrome_port }}
}
